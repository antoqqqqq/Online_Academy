<link rel="stylesheet" href="/css/search.css"> <!-- Search Header -->
<link rel="stylesheet" href="/css/course_card.css">
<div class="search-header">
    <div class="container">
        <h1 class="text-center mb-4">Tìm Kiếm Khóa Học</h1>
        <form class="search-box" method="post" action="/courses/search">
            <div class="input-group">
                <input type="text" class="form-control" id="searchInput" name="searchInput"
                    placeholder="Tìm kiếm khóa học, giảng viên, chủ đề..." value="{{q}}">
                <button class="btn btn-warning" type="submit">
                    <i class="fas fa-search"></i> Tìm Kiếm
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Search Results -->
<div class="container">
    <div class="row">
        <!-- Filter Sidebar -->
        <div class="col-lg-3">
            <div class="filter-sidebar">
                <form id="filterForm" method="post" action="/courses/search">
                    <input type="hidden" name="searchInput" id="searchInputHidden" value="{{q}}">
                    <h5 class="filter-title"><i class="fas fa-filter"></i> Bộ Lọc</h5>

                    <div class="filter-group">
                        <h6>Danh Mục</h6>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="category" id="catAll" value="0" {{#if (eq category 0)}}checked{{/if}}>
                            <label class="form-check-label" for="catAll">Tất cả</label>
                        </div>
                        {{#each categories}}
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="category" id="cat{{@index}}" 
                                value="{{this.id}}" {{#if (eq ../category this.id)}}checked{{/if}}> 
                            <label class="form-check-label" for="cat{{@index}}">{{name}}</label>
                        </div>
                        {{/each}}
                    </div>

                    <div class="filter-group">
                        <h6>Giá</h6>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="price" id="priceAll" value="0" {{#if (eq price 0)}}checked{{/if}}>
                            <label class="form-check-label" for="priceAll">Tất cả</label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" name="price" id="pricePaid" value="2" {{#if (eq price 2)}}checked{{/if}}>
                            <label class="form-check-label" for="pricePaid">Giảm giá</label>
                        </div>
                    </div>

                    <div class="filter-group">
                        <h6>Đánh Giá</h6>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="ratingAll" name="rating" value="0"{{#if (eq rating 0)}}checked{{/if}}>
                            <label class="form-check-label" for="rating0">
                                <i class="fas fa-star text-warning"></i> Tất cả
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="rating45" name="rating" value="4.5" {{#if (eq rating 4.5)}}checked{{/if}}>
                            <label class="form-check-label" for="rating45">
                                <i class="fas fa-star text-warning"></i> 4.5 trở lên
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="rating4" name="rating" value="4" {{#if (eq rating 4)}}checked{{/if}}>
                            <label class="form-check-label" for="rating4">
                                <i class="fas fa-star text-warning"></i> 4.0 trở lên
                            </label>
                        </div>
                        <div class="form-check">
                            <input class="form-check-input" type="radio" id="rating35" name="rating" value="3.5" {{#if (eq rating 3.5)}}checked{{/if}}>
                            <label class="form-check-label" for="rating35">
                                <i class="fas fa-star text-warning"></i> 3.5 trở lên
                            </label>
                        </div>
                    </div>

                    <button class="btn btn-primary w-100" onclick="applyFilters()">
                        <i class="fas fa-check"></i> Áp Dụng Lọc
                    </button>
                </form>
            </div>
        </div>

        <!-- Results -->
        <div class="col-lg-9">
            <div class="search-results-info">
                <h5>
                    Tìm thấy <strong id="resultCount">{{amount}}</strong> kết quả cho "<strong
                        id="searchQuery">{{q}}</strong>"
                </h5>
                <div class="mt-3">
                    <label class="me-2">Sắp xếp:</label>
                    <select class="form-select d-inline-block w-auto" id="sortBy" onchange="sortResults()">
                        <option value="relevance">Liên quan nhất</option>
                        <option value="newest">Mới nhất</option>
                        <option value="popular">Phổ biến nhất</option>
                        <option value="rating">Đánh giá cao nhất</option>
                        <option value="price-low">Giá thấp đến cao</option>
                        <option value="price-high">Giá cao đến thấp</option>
                    </select>
                </div>
            </div>

            <div class="row" id="coursesContainer">
                <!-- Course 1 -->

                {{#each course_card}}
                <div class="col-md-6 col-lg-4">
                    {{> course_card}}
                </div>
                {{/each}}

                <!-- Pagination -->
            </div>
        </div>
    </div>
</div>
